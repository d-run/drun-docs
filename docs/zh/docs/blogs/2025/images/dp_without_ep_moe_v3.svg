<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg
   viewBox="0 0 1102 731"
   style="font-size:12px;font-family:Arial"
   version="1.1"
   id="svg_dp_without_ep"
   sodipodi:docname="dp_without_ep_moe_v3.svg"
   inkscape:version="1.4.2 (f4327f4, 2025-05-13)"
   inkscape:export-filename="dp_without_ep_moe.png"
   inkscape:export-xdpi="150"
   inkscape:export-ydpi="150"
   width="1102"
   height="731"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:svg="http://www.w3.org/2000/svg">
  <sodipodi:namedview
     id="namedview1"
     pagecolor="#ffffff"
     bordercolor="#000000"
     borderopacity="0.25"
     inkscape:showpageshadow="2"
     inkscape:pageopacity="0.0"
     inkscape:pagecheckerboard="0"
     inkscape:deskcolor="#d1d1d1"
     inkscape:zoom="1.094087"
     inkscape:cx="632.03383"
     inkscape:cy="429.12492"
     inkscape:window-width="1920"
     inkscape:window-height="1111"
     inkscape:window-x="-9"
     inkscape:window-y="-9"
     inkscape:window-maximized="1"
     inkscape:current-layer="svg_dp_without_ep" />
  <!-- Title Box -->
  <rect
     x="1"
     y="1"
     width="1100"
     height="50"
     fill="#2c3e50"
     stroke="#34495e"
     stroke-width="2"
     rx="5"
     id="rect_title"
     inkscape:export-filename="DP_without_EP.png"
     inkscape:export-xdpi="150"
     inkscape:export-ydpi="150" />
  <text
     x="580.72974"
     y="32.122208"
     text-anchor="middle"
     fill="#ffffff"
     font-size="20px"
     font-weight="bold"
     id="text_title">DP=8 WITHOUT Expert Parallelism</text>
  <!-- Load Balancer Box -->
  <rect
     x="410"
     y="81"
     width="350"
     height="40"
     fill="#9b59b6"
     stroke="#8e44ad"
     stroke-width="2"
     rx="5"
     id="rect_lb" />
  <text
     x="585"
     y="106"
     text-anchor="middle"
     fill="#ffffff"
     font-weight="bold"
     font-size="16px"
     id="text_lb">Request Load Balancer (Router)</text>
  <!-- Fan out lines from load balancer to 8 requests -->
  <line
     x1="410"
     y1="121"
     x2="135"
     y2="171"
     stroke="#7f8c8d"
     stroke-width="2"
     id="line1" />
  <line
     x1="460"
     y1="121"
     x2="260"
     y2="171"
     stroke="#7f8c8d"
     stroke-width="2"
     id="line2" />
  <line
     x1="510"
     y1="121"
     x2="385"
     y2="171"
     stroke="#7f8c8d"
     stroke-width="2"
     id="line3" />
  <line
     x1="560"
     y1="121"
     x2="510"
     y2="171"
     stroke="#7f8c8d"
     stroke-width="2"
     id="line4" />
  <line
     x1="610"
     y1="121"
     x2="635"
     y2="171"
     stroke="#7f8c8d"
     stroke-width="2"
     id="line5" />
  <line
     x1="660"
     y1="121"
     x2="760"
     y2="171"
     stroke="#7f8c8d"
     stroke-width="2"
     id="line6" />
  <line
     x1="710"
     y1="121"
     x2="885"
     y2="171"
     stroke="#7f8c8d"
     stroke-width="2"
     id="line7" />
  <line
     x1="760"
     y1="121"
     x2="1010"
     y2="171"
     stroke="#7f8c8d"
     stroke-width="2"
     id="line8" />
  <!-- Request Boxes (8 different requests) -->
  <rect
     x="85"
     y="171"
     width="100"
     height="40"
     fill="#3498db"
     stroke="#2980b9"
     stroke-width="2"
     rx="3"
     id="rect_req_a" />
  <text
     x="135"
     y="191"
     text-anchor="middle"
     fill="#ffffff"
     font-weight="bold"
     font-size="13px"
     id="text_req_a1">Req A</text>
  <text
     x="135"
     y="206"
     text-anchor="middle"
     fill="#ffffff"
     font-size="11px"
     id="text_req_a2">(diff)</text>
  <rect
     x="210"
     y="171"
     width="100"
     height="40"
     fill="#3498db"
     stroke="#2980b9"
     stroke-width="2"
     rx="3"
     id="rect_req_b" />
  <text
     x="260"
     y="191"
     text-anchor="middle"
     fill="#ffffff"
     font-weight="bold"
     font-size="13px"
     id="text_req_b1">Req B</text>
  <text
     x="260"
     y="206"
     text-anchor="middle"
     fill="#ffffff"
     font-size="11px"
     id="text_req_b2">(diff)</text>
  <rect
     x="335"
     y="171"
     width="100"
     height="40"
     fill="#3498db"
     stroke="#2980b9"
     stroke-width="2"
     rx="3"
     id="rect_req_c" />
  <text
     x="385"
     y="191"
     text-anchor="middle"
     fill="#ffffff"
     font-weight="bold"
     font-size="13px"
     id="text_req_c1">Req C</text>
  <text
     x="385"
     y="206"
     text-anchor="middle"
     fill="#ffffff"
     font-size="11px"
     id="text_req_c2">(diff)</text>
  <rect
     x="460"
     y="171"
     width="100"
     height="40"
     fill="#3498db"
     stroke="#2980b9"
     stroke-width="2"
     rx="3"
     id="rect_req_d" />
  <text
     x="510"
     y="191"
     text-anchor="middle"
     fill="#ffffff"
     font-weight="bold"
     font-size="13px"
     id="text_req_d1">Req D</text>
  <text
     x="510"
     y="206"
     text-anchor="middle"
     fill="#ffffff"
     font-size="11px"
     id="text_req_d2">(diff)</text>
  <rect
     x="585"
     y="171"
     width="100"
     height="40"
     fill="#3498db"
     stroke="#2980b9"
     stroke-width="2"
     rx="3"
     id="rect_req_e" />
  <text
     x="635"
     y="191"
     text-anchor="middle"
     fill="#ffffff"
     font-weight="bold"
     font-size="13px"
     id="text_req_e1">Req E</text>
  <text
     x="635"
     y="206"
     text-anchor="middle"
     fill="#ffffff"
     font-size="11px"
     id="text_req_e2">(diff)</text>
  <rect
     x="710"
     y="171"
     width="100"
     height="40"
     fill="#3498db"
     stroke="#2980b9"
     stroke-width="2"
     rx="3"
     id="rect_req_f" />
  <text
     x="760"
     y="191"
     text-anchor="middle"
     fill="#ffffff"
     font-weight="bold"
     font-size="13px"
     id="text_req_f1">Req F</text>
  <text
     x="760"
     y="206"
     text-anchor="middle"
     fill="#ffffff"
     font-size="11px"
     id="text_req_f2">(diff)</text>
  <rect
     x="835"
     y="171"
     width="100"
     height="40"
     fill="#3498db"
     stroke="#2980b9"
     stroke-width="2"
     rx="3"
     id="rect_req_g" />
  <text
     x="885"
     y="191"
     text-anchor="middle"
     fill="#ffffff"
     font-weight="bold"
     font-size="13px"
     id="text_req_g1">Req G</text>
  <text
     x="885"
     y="206"
     text-anchor="middle"
     fill="#ffffff"
     font-size="11px"
     id="text_req_g2">(diff)</text>
  <rect
     x="960"
     y="171"
     width="100"
     height="40"
     fill="#3498db"
     stroke="#2980b9"
     stroke-width="2"
     rx="3"
     id="rect_req_h" />
  <text
     x="1010"
     y="191"
     text-anchor="middle"
     fill="#ffffff"
     font-weight="bold"
     font-size="13px"
     id="text_req_h1">Req H</text>
  <text
     x="1010"
     y="206"
     text-anchor="middle"
     fill="#ffffff"
     font-size="11px"
     id="text_req_h2">(diff)</text>
  <!-- Arrows from requests to GPUs -->
  <line
     x1="135"
     y1="211"
     x2="135"
     y2="241"
     stroke="#34495e"
     stroke-width="2"
     marker-end="url(#arrow)"
     id="arrow1" />
  <line
     x1="260"
     y1="211"
     x2="260"
     y2="241"
     stroke="#34495e"
     stroke-width="2"
     marker-end="url(#arrow)"
     id="arrow2" />
  <line
     x1="385"
     y1="211"
     x2="385"
     y2="241"
     stroke="#34495e"
     stroke-width="2"
     marker-end="url(#arrow)"
     id="arrow3" />
  <line
     x1="510"
     y1="211"
     x2="510"
     y2="241"
     stroke="#34495e"
     stroke-width="2"
     marker-end="url(#arrow)"
     id="arrow4" />
  <line
     x1="635"
     y1="211"
     x2="635"
     y2="241"
     stroke="#34495e"
     stroke-width="2"
     marker-end="url(#arrow)"
     id="arrow5" />
  <line
     x1="760"
     y1="211"
     x2="760"
     y2="241"
     stroke="#34495e"
     stroke-width="2"
     marker-end="url(#arrow)"
     id="arrow6" />
  <line
     x1="885"
     y1="211"
     x2="885"
     y2="241"
     stroke="#34495e"
     stroke-width="2"
     marker-end="url(#arrow)"
     id="arrow7" />
  <line
     x1="1010"
     y1="211"
     x2="1010"
     y2="241"
     stroke="#34495e"
     stroke-width="2"
     marker-end="url(#arrow)"
     id="arrow8" />
  <!-- GPU Labels -->
  <text
     x="135"
     y="261"
     text-anchor="middle"
     fill="#2c3e50"
     font-size="13px"
     font-weight="bold"
     id="gpu0">GPU 0</text>
  <text
     x="260"
     y="261"
     text-anchor="middle"
     fill="#2c3e50"
     font-size="13px"
     font-weight="bold"
     id="gpu1">GPU 1</text>
  <text
     x="385"
     y="261"
     text-anchor="middle"
     fill="#2c3e50"
     font-size="13px"
     font-weight="bold"
     id="gpu2">GPU 2</text>
  <text
     x="510"
     y="261"
     text-anchor="middle"
     fill="#2c3e50"
     font-size="13px"
     font-weight="bold"
     id="gpu3">GPU 3</text>
  <text
     x="635"
     y="261"
     text-anchor="middle"
     fill="#2c3e50"
     font-size="13px"
     font-weight="bold"
     id="gpu4">GPU 4</text>
  <text
     x="760"
     y="261"
     text-anchor="middle"
     fill="#2c3e50"
     font-size="13px"
     font-weight="bold"
     id="gpu5">GPU 5</text>
  <text
     x="885"
     y="261"
     text-anchor="middle"
     fill="#2c3e50"
     font-size="13px"
     font-weight="bold"
     id="gpu6">GPU 6</text>
  <text
     x="1010"
     y="261"
     text-anchor="middle"
     fill="#2c3e50"
     font-size="13px"
     font-weight="bold"
     id="gpu7">GPU 7</text>
  <!-- Attention Layer (individual boxes) -->
  <rect
     x="85"
     y="276"
     width="100"
     height="80"
     fill="#e74c3c"
     stroke="#c0392b"
     stroke-width="2"
     rx="3"
     id="rect_attn0" />
  <text
     x="135"
     y="296"
     text-anchor="middle"
     fill="#ffffff"
     font-size="12px"
     font-weight="bold"
     id="attn0_1">Attn Layer</text>
  <text
     x="135"
     y="311"
     text-anchor="middle"
     fill="#ffffff"
     font-size="11px"
     id="attn0_2">(Full)</text>
  <text
     x="135"
     y="326"
     text-anchor="middle"
     fill="#ffffff"
     font-size="11px"
     font-weight="bold"
     id="attn0_3">KV: A</text>
  <rect
     x="210"
     y="276"
     width="100"
     height="80"
     fill="#e74c3c"
     stroke="#c0392b"
     stroke-width="2"
     rx="3"
     id="rect_attn1" />
  <text
     x="260"
     y="296"
     text-anchor="middle"
     fill="#ffffff"
     font-size="12px"
     font-weight="bold"
     id="attn1_1">Attn Layer</text>
  <text
     x="260"
     y="311"
     text-anchor="middle"
     fill="#ffffff"
     font-size="11px"
     id="attn1_2">(Full)</text>
  <text
     x="260"
     y="326"
     text-anchor="middle"
     fill="#ffffff"
     font-size="11px"
     font-weight="bold"
     id="attn1_3">KV: B</text>
  <rect
     x="335"
     y="276"
     width="100"
     height="80"
     fill="#e74c3c"
     stroke="#c0392b"
     stroke-width="2"
     rx="3"
     id="rect_attn2" />
  <text
     x="385"
     y="296"
     text-anchor="middle"
     fill="#ffffff"
     font-size="12px"
     font-weight="bold"
     id="attn2_1">Attn Layer</text>
  <text
     x="385"
     y="311"
     text-anchor="middle"
     fill="#ffffff"
     font-size="11px"
     id="attn2_2">(Full)</text>
  <text
     x="385"
     y="326"
     text-anchor="middle"
     fill="#ffffff"
     font-size="11px"
     font-weight="bold"
     id="attn2_3">KV: C</text>
  <rect
     x="460"
     y="276"
     width="100"
     height="80"
     fill="#e74c3c"
     stroke="#c0392b"
     stroke-width="2"
     rx="3"
     id="rect_attn3" />
  <text
     x="510"
     y="296"
     text-anchor="middle"
     fill="#ffffff"
     font-size="12px"
     font-weight="bold"
     id="attn3_1">Attn Layer</text>
  <text
     x="510"
     y="311"
     text-anchor="middle"
     fill="#ffffff"
     font-size="11px"
     id="attn3_2">(Full)</text>
  <text
     x="510"
     y="326"
     text-anchor="middle"
     fill="#ffffff"
     font-size="11px"
     font-weight="bold"
     id="attn3_3">KV: D</text>
  <rect
     x="585"
     y="276"
     width="100"
     height="80"
     fill="#e74c3c"
     stroke="#c0392b"
     stroke-width="2"
     rx="3"
     id="rect_attn4" />
  <text
     x="635"
     y="296"
     text-anchor="middle"
     fill="#ffffff"
     font-size="12px"
     font-weight="bold"
     id="attn4_1">Attn Layer</text>
  <text
     x="635"
     y="311"
     text-anchor="middle"
     fill="#ffffff"
     font-size="11px"
     id="attn4_2">(Full)</text>
  <text
     x="635"
     y="326"
     text-anchor="middle"
     fill="#ffffff"
     font-size="11px"
     font-weight="bold"
     id="attn4_3">KV: E</text>
  <rect
     x="710"
     y="276"
     width="100"
     height="80"
     fill="#e74c3c"
     stroke="#c0392b"
     stroke-width="2"
     rx="3"
     id="rect_attn5" />
  <text
     x="760"
     y="296"
     text-anchor="middle"
     fill="#ffffff"
     font-size="12px"
     font-weight="bold"
     id="attn5_1">Attn Layer</text>
  <text
     x="760"
     y="311"
     text-anchor="middle"
     fill="#ffffff"
     font-size="11px"
     id="attn5_2">(Full)</text>
  <text
     x="760"
     y="326"
     text-anchor="middle"
     fill="#ffffff"
     font-size="11px"
     font-weight="bold"
     id="attn5_3">KV: F</text>
  <rect
     x="835"
     y="276"
     width="100"
     height="80"
     fill="#e74c3c"
     stroke="#c0392b"
     stroke-width="2"
     rx="3"
     id="rect_attn6" />
  <text
     x="885"
     y="296"
     text-anchor="middle"
     fill="#ffffff"
     font-size="12px"
     font-weight="bold"
     id="attn6_1">Attn Layer</text>
  <text
     x="885"
     y="311"
     text-anchor="middle"
     fill="#ffffff"
     font-size="11px"
     id="attn6_2">(Full)</text>
  <text
     x="885"
     y="326"
     text-anchor="middle"
     fill="#ffffff"
     font-size="11px"
     font-weight="bold"
     id="attn6_3">KV: G</text>
  <rect
     x="960"
     y="276"
     width="100"
     height="80"
     fill="#e74c3c"
     stroke="#c0392b"
     stroke-width="2"
     rx="3"
     id="rect_attn7" />
  <text
     x="1010"
     y="296"
     text-anchor="middle"
     fill="#ffffff"
     font-size="12px"
     font-weight="bold"
     id="attn7_1">Attn Layer</text>
  <text
     x="1010"
     y="311"
     text-anchor="middle"
     fill="#ffffff"
     font-size="11px"
     id="attn7_2">(Full)</text>
  <text
     x="1010"
     y="326"
     text-anchor="middle"
     fill="#ffffff"
     font-size="11px"
     font-weight="bold"
     id="attn7_3">KV: H</text>
  <!-- Communication note -->
  <!-- Shared Experts Layer (individual boxes) -->
  <!-- Shared experts label -->
  <!-- No communication note for shared experts -->
  <!-- Routed Experts Layer -->
  <rect
     x="85"
     y="430"
     width="975"
     height="55"
     fill="#f39c12"
     stroke="#d68910"
     stroke-width="2"
     rx="3"
     id="rect_routed" />
  <!-- Routed experts label -->
  <text
     x="77.742012"
     y="451.88208"
     text-anchor="end"
     fill="#2c3e50"
     font-size="10px"
     font-weight="bold"
     id="routed_label1"
     style="font-size:12px"><tspan
       sodipodi:role="line"
       id="tspan3"
       x="77.742012"
       y="451.88208">Routed</tspan><tspan
       sodipodi:role="line"
       id="tspan4"
       x="77.742012"
       y="466.88208">Experts</tspan></text>
  <!-- AllReduce for routed experts -->
  <line
     x1="135"
     y1="500"
     x2="1010"
     y2="500"
     stroke="#9b59b6"
     stroke-width="3"
     stroke-dasharray="5, 5"
     marker-start="url(#arrowhead-left)"
     marker-end="url(#arrowhead-purple)"
     id="allreduce_routed" />
  <text
     x="585"
     y="515"
     text-anchor="middle"
     fill="#8e44ad"
     font-size="12px"
     font-weight="normal"
     id="allreduce_text">ReduceScatter (reduce+distribute)</text>
  <line
     x1="135.19217"
     y1="367.81464"
     x2="1010.1923"
     y2="367.81464"
     stroke="#9b59b6"
     stroke-width="3"
     stroke-dasharray="5, 5"
     marker-start="url(#arrowhead-left-0)"
     marker-end="url(#arrowhead-purple-4)"
     id="allreduce_routed-2"
     style="font-size:12px;font-family:Arial;marker-start:url(#arrowhead-left-0);marker-end:url(#arrowhead-purple-4)" />
  <text
     x="585.1922"
     y="380.81464"
     text-anchor="middle"
     fill="#8e44ad"
     font-size="12px"
     font-weight="normal"
     id="allreduce_text-4"
     style="font-size:12px;font-family:Arial">AllGather (gather all outputs)</text>
  <!-- Dense Layer (individual boxes) -->
  <rect
     x="85"
     y="530"
     width="100"
     height="70"
     fill="#27ae60"
     stroke="#229954"
     stroke-width="2"
     rx="3"
     id="rect_dense0" />
  <text
     x="135"
     y="550"
     text-anchor="middle"
     fill="#ffffff"
     font-size="13px"
     font-weight="bold"
     id="dense0_1">Dense</text>
  <text
     x="135"
     y="565"
     text-anchor="middle"
     fill="#ffffff"
     font-size="13px"
     font-weight="bold"
     id="dense0_2">Layer</text>
  <text
     x="135"
     y="585"
     text-anchor="middle"
     fill="#ffffff"
     font-size="12px"
     id="dense0_3">(Full)</text>
  <rect
     x="210"
     y="530"
     width="100"
     height="70"
     fill="#27ae60"
     stroke="#229954"
     stroke-width="2"
     rx="3"
     id="rect_dense1" />
  <text
     x="260"
     y="550"
     text-anchor="middle"
     fill="#ffffff"
     font-size="13px"
     font-weight="bold"
     id="dense1_1">Dense</text>
  <text
     x="260"
     y="565"
     text-anchor="middle"
     fill="#ffffff"
     font-size="13px"
     font-weight="bold"
     id="dense1_2">Layer</text>
  <text
     x="260"
     y="585"
     text-anchor="middle"
     fill="#ffffff"
     font-size="12px"
     id="dense1_3">(Full)</text>
  <rect
     x="335"
     y="530"
     width="100"
     height="70"
     fill="#27ae60"
     stroke="#229954"
     stroke-width="2"
     rx="3"
     id="rect_dense2" />
  <text
     x="385"
     y="550"
     text-anchor="middle"
     fill="#ffffff"
     font-size="13px"
     font-weight="bold"
     id="dense2_1">Dense</text>
  <text
     x="385"
     y="565"
     text-anchor="middle"
     fill="#ffffff"
     font-size="13px"
     font-weight="bold"
     id="dense2_2">Layer</text>
  <text
     x="385"
     y="585"
     text-anchor="middle"
     fill="#ffffff"
     font-size="12px"
     id="dense2_3">(Full)</text>
  <rect
     x="460"
     y="530"
     width="100"
     height="70"
     fill="#27ae60"
     stroke="#229954"
     stroke-width="2"
     rx="3"
     id="rect_dense3" />
  <text
     x="510"
     y="550"
     text-anchor="middle"
     fill="#ffffff"
     font-size="13px"
     font-weight="bold"
     id="dense3_1">Dense</text>
  <text
     x="510"
     y="565"
     text-anchor="middle"
     fill="#ffffff"
     font-size="13px"
     font-weight="bold"
     id="dense3_2">Layer</text>
  <text
     x="510"
     y="585"
     text-anchor="middle"
     fill="#ffffff"
     font-size="12px"
     id="dense3_3">(Full)</text>
  <rect
     x="585"
     y="530"
     width="100"
     height="70"
     fill="#27ae60"
     stroke="#229954"
     stroke-width="2"
     rx="3"
     id="rect_dense4" />
  <text
     x="635"
     y="550"
     text-anchor="middle"
     fill="#ffffff"
     font-size="13px"
     font-weight="bold"
     id="dense4_1">Dense</text>
  <text
     x="635"
     y="565"
     text-anchor="middle"
     fill="#ffffff"
     font-size="13px"
     font-weight="bold"
     id="dense4_2">Layer</text>
  <text
     x="635"
     y="585"
     text-anchor="middle"
     fill="#ffffff"
     font-size="12px"
     id="dense4_3">(Full)</text>
  <rect
     x="710"
     y="530"
     width="100"
     height="70"
     fill="#27ae60"
     stroke="#229954"
     stroke-width="2"
     rx="3"
     id="rect_dense5" />
  <text
     x="760"
     y="550"
     text-anchor="middle"
     fill="#ffffff"
     font-size="13px"
     font-weight="bold"
     id="dense5_1">Dense</text>
  <text
     x="760"
     y="565"
     text-anchor="middle"
     fill="#ffffff"
     font-size="13px"
     font-weight="bold"
     id="dense5_2">Layer</text>
  <text
     x="760"
     y="585"
     text-anchor="middle"
     fill="#ffffff"
     font-size="12px"
     id="dense5_3">(Full)</text>
  <rect
     x="835"
     y="530"
     width="100"
     height="70"
     fill="#27ae60"
     stroke="#229954"
     stroke-width="2"
     rx="3"
     id="rect_dense6" />
  <text
     x="885"
     y="550"
     text-anchor="middle"
     fill="#ffffff"
     font-size="13px"
     font-weight="bold"
     id="dense6_1">Dense</text>
  <text
     x="885"
     y="565"
     text-anchor="middle"
     fill="#ffffff"
     font-size="13px"
     font-weight="bold"
     id="dense6_2">Layer</text>
  <text
     x="885"
     y="585"
     text-anchor="middle"
     fill="#ffffff"
     font-size="12px"
     id="dense6_3">(Full)</text>
  <rect
     x="960"
     y="530"
     width="100"
     height="70"
     fill="#27ae60"
     stroke="#229954"
     stroke-width="2"
     rx="3"
     id="rect_dense7" />
  <text
     x="1010"
     y="550"
     text-anchor="middle"
     fill="#ffffff"
     font-size="13px"
     font-weight="bold"
     id="dense7_1">Dense</text>
  <text
     x="1010"
     y="565"
     text-anchor="middle"
     fill="#ffffff"
     font-size="13px"
     font-weight="bold"
     id="dense7_2">Layer</text>
  <text
     x="1010"
     y="585"
     text-anchor="middle"
     fill="#ffffff"
     font-size="12px"
     id="dense7_3">(Full)</text>
  <!-- Arrows from dense to outputs -->
  <line
     x1="135"
     y1="600"
     x2="135"
     y2="630"
     stroke="#34495e"
     stroke-width="2"
     marker-end="url(#arrow)"
     id="arrow_out1" />
  <line
     x1="260"
     y1="600"
     x2="260"
     y2="630"
     stroke="#34495e"
     stroke-width="2"
     marker-end="url(#arrow)"
     id="arrow_out2" />
  <line
     x1="385"
     y1="600"
     x2="385"
     y2="630"
     stroke="#34495e"
     stroke-width="2"
     marker-end="url(#arrow)"
     id="arrow_out3" />
  <line
     x1="510"
     y1="600"
     x2="510"
     y2="630"
     stroke="#34495e"
     stroke-width="2"
     marker-end="url(#arrow)"
     id="arrow_out4" />
  <line
     x1="635"
     y1="600"
     x2="635"
     y2="630"
     stroke="#34495e"
     stroke-width="2"
     marker-end="url(#arrow)"
     id="arrow_out5" />
  <line
     x1="760"
     y1="600"
     x2="760"
     y2="630"
     stroke="#34495e"
     stroke-width="2"
     marker-end="url(#arrow)"
     id="arrow_out6" />
  <line
     x1="885"
     y1="600"
     x2="885"
     y2="630"
     stroke="#34495e"
     stroke-width="2"
     marker-end="url(#arrow)"
     id="arrow_out7" />
  <line
     x1="1010"
     y1="600"
     x2="1010"
     y2="630"
     stroke="#34495e"
     stroke-width="2"
     marker-end="url(#arrow)"
     id="arrow_out8" />
  <!-- Output Boxes -->
  <rect
     x="85"
     y="630"
     width="100"
     height="35"
     fill="#27ae60"
     stroke="#229954"
     stroke-width="2"
     rx="3"
     id="rect_out_a" />
  <text
     x="135"
     y="652"
     text-anchor="middle"
     fill="#ffffff"
     font-weight="bold"
     font-size="13px"
     id="text_out_a">Out A</text>
  <rect
     x="210"
     y="630"
     width="100"
     height="35"
     fill="#27ae60"
     stroke="#229954"
     stroke-width="2"
     rx="3"
     id="rect_out_b" />
  <text
     x="260"
     y="652"
     text-anchor="middle"
     fill="#ffffff"
     font-weight="bold"
     font-size="13px"
     id="text_out_b">Out B</text>
  <rect
     x="335"
     y="630"
     width="100"
     height="35"
     fill="#27ae60"
     stroke="#229954"
     stroke-width="2"
     rx="3"
     id="rect_out_c" />
  <text
     x="385"
     y="652"
     text-anchor="middle"
     fill="#ffffff"
     font-weight="bold"
     font-size="13px"
     id="text_out_c">Out C</text>
  <rect
     x="460"
     y="630"
     width="100"
     height="35"
     fill="#27ae60"
     stroke="#229954"
     stroke-width="2"
     rx="3"
     id="rect_out_d" />
  <text
     x="510"
     y="652"
     text-anchor="middle"
     fill="#ffffff"
     font-weight="bold"
     font-size="13px"
     id="text_out_d">Out D</text>
  <rect
     x="585"
     y="630"
     width="100"
     height="35"
     fill="#27ae60"
     stroke="#229954"
     stroke-width="2"
     rx="3"
     id="rect_out_e" />
  <text
     x="635"
     y="652"
     text-anchor="middle"
     fill="#ffffff"
     font-weight="bold"
     font-size="13px"
     id="text_out_e">Out E</text>
  <rect
     x="710"
     y="630"
     width="100"
     height="35"
     fill="#27ae60"
     stroke="#229954"
     stroke-width="2"
     rx="3"
     id="rect_out_f" />
  <text
     x="760"
     y="652"
     text-anchor="middle"
     fill="#ffffff"
     font-weight="bold"
     font-size="13px"
     id="text_out_f">Out F</text>
  <rect
     x="835"
     y="630"
     width="100"
     height="35"
     fill="#27ae60"
     stroke="#229954"
     stroke-width="2"
     rx="3"
     id="rect_out_g" />
  <text
     x="885"
     y="652"
     text-anchor="middle"
     fill="#ffffff"
     font-weight="bold"
     font-size="13px"
     id="text_out_g">Out G</text>
  <rect
     x="960"
     y="630"
     width="100"
     height="35"
     fill="#27ae60"
     stroke="#229954"
     stroke-width="2"
     rx="3"
     id="rect_out_h" />
  <text
     x="1010"
     y="652"
     text-anchor="middle"
     fill="#ffffff"
     font-weight="bold"
     font-size="13px"
     id="text_out_h">Out H</text>
  <!-- Arrows to response boxes -->
  <line
     x1="135"
     y1="665"
     x2="135"
     y2="695"
     stroke="#34495e"
     stroke-width="2"
     marker-end="url(#arrow)"
     id="arrow_resp1" />
  <line
     x1="260"
     y1="665"
     x2="260"
     y2="695"
     stroke="#34495e"
     stroke-width="2"
     marker-end="url(#arrow)"
     id="arrow_resp2" />
  <line
     x1="385"
     y1="665"
     x2="385"
     y2="695"
     stroke="#34495e"
     stroke-width="2"
     marker-end="url(#arrow)"
     id="arrow_resp3" />
  <line
     x1="510"
     y1="665"
     x2="510"
     y2="695"
     stroke="#34495e"
     stroke-width="2"
     marker-end="url(#arrow)"
     id="arrow_resp4" />
  <line
     x1="635"
     y1="665"
     x2="635"
     y2="695"
     stroke="#34495e"
     stroke-width="2"
     marker-end="url(#arrow)"
     id="arrow_resp5" />
  <line
     x1="760"
     y1="665"
     x2="760"
     y2="695"
     stroke="#34495e"
     stroke-width="2"
     marker-end="url(#arrow)"
     id="arrow_resp6" />
  <line
     x1="885"
     y1="665"
     x2="885"
     y2="695"
     stroke="#34495e"
     stroke-width="2"
     marker-end="url(#arrow)"
     id="arrow_resp7" />
  <line
     x1="1010"
     y1="665"
     x2="1010"
     y2="695"
     stroke="#34495e"
     stroke-width="2"
     marker-end="url(#arrow)"
     id="arrow_resp8" />
  <!-- Response Boxes -->
  <rect
     x="85"
     y="695"
     width="100"
     height="35"
     fill="#3498db"
     stroke="#2980b9"
     stroke-width="2"
     rx="3"
     id="rect_resp_a" />
  <text
     x="135"
     y="717"
     text-anchor="middle"
     fill="#ffffff"
     font-weight="bold"
     font-size="13px"
     id="text_resp_a">Resp A</text>
  <rect
     x="210"
     y="695"
     width="100"
     height="35"
     fill="#3498db"
     stroke="#2980b9"
     stroke-width="2"
     rx="3"
     id="rect_resp_b" />
  <text
     x="260"
     y="717"
     text-anchor="middle"
     fill="#ffffff"
     font-weight="bold"
     font-size="13px"
     id="text_resp_b">Resp B</text>
  <rect
     x="335"
     y="695"
     width="100"
     height="35"
     fill="#3498db"
     stroke="#2980b9"
     stroke-width="2"
     rx="3"
     id="rect_resp_c" />
  <text
     x="385"
     y="717"
     text-anchor="middle"
     fill="#ffffff"
     font-weight="bold"
     font-size="13px"
     id="text_resp_c">Resp C</text>
  <rect
     x="460"
     y="695"
     width="100"
     height="35"
     fill="#3498db"
     stroke="#2980b9"
     stroke-width="2"
     rx="3"
     id="rect_resp_d" />
  <text
     x="510"
     y="717"
     text-anchor="middle"
     fill="#ffffff"
     font-weight="bold"
     font-size="13px"
     id="text_resp_d">Resp D</text>
  <rect
     x="585"
     y="695"
     width="100"
     height="35"
     fill="#3498db"
     stroke="#2980b9"
     stroke-width="2"
     rx="3"
     id="rect_resp_e" />
  <text
     x="635"
     y="717"
     text-anchor="middle"
     fill="#ffffff"
     font-weight="bold"
     font-size="13px"
     id="text_resp_e">Resp E</text>
  <rect
     x="710"
     y="695"
     width="100"
     height="35"
     fill="#3498db"
     stroke="#2980b9"
     stroke-width="2"
     rx="3"
     id="rect_resp_f" />
  <text
     x="760"
     y="717"
     text-anchor="middle"
     fill="#ffffff"
     font-weight="bold"
     font-size="13px"
     id="text_resp_f">Resp F</text>
  <rect
     x="835"
     y="695"
     width="100"
     height="35"
     fill="#3498db"
     stroke="#2980b9"
     stroke-width="2"
     rx="3"
     id="rect_resp_g" />
  <text
     x="885"
     y="717"
     text-anchor="middle"
     fill="#ffffff"
     font-weight="bold"
     font-size="13px"
     id="text_resp_g">Resp G</text>
  <rect
     x="960"
     y="695"
     width="100"
     height="35"
     fill="#3498db"
     stroke="#2980b9"
     stroke-width="2"
     rx="3"
     id="rect_resp_h" />
  <text
     x="1010"
     y="717"
     text-anchor="middle"
     fill="#ffffff"
     font-weight="bold"
     font-size="13px"
     id="text_resp_h">Resp H</text>
  <!-- Vertical dashed lines for GPU boundaries -->
  <line
     x1="197"
     y1="266"
     x2="197"
     y2="646"
     stroke="#34495e"
     stroke-width="2"
     stroke-dasharray="10, 10"
     stroke-opacity="0.3"
     id="boundary1" />
  <line
     x1="322"
     y1="266"
     x2="322"
     y2="646"
     stroke="#34495e"
     stroke-width="2"
     stroke-dasharray="10, 10"
     stroke-opacity="0.3"
     id="boundary2" />
  <line
     x1="447"
     y1="266"
     x2="447"
     y2="646"
     stroke="#34495e"
     stroke-width="2"
     stroke-dasharray="10, 10"
     stroke-opacity="0.3"
     id="boundary3" />
  <line
     x1="572"
     y1="266"
     x2="572"
     y2="646"
     stroke="#34495e"
     stroke-width="2"
     stroke-dasharray="10, 10"
     stroke-opacity="0.3"
     id="boundary4" />
  <line
     x1="697"
     y1="266"
     x2="697"
     y2="646"
     stroke="#34495e"
     stroke-width="2"
     stroke-dasharray="10, 10"
     stroke-opacity="0.3"
     id="boundary5" />
  <line
     x1="822"
     y1="266"
     x2="822"
     y2="646"
     stroke="#34495e"
     stroke-width="2"
     stroke-dasharray="10, 10"
     stroke-opacity="0.3"
     id="boundary6" />
  <line
     x1="947"
     y1="266"
     x2="947"
     y2="646"
     stroke="#34495e"
     stroke-width="2"
     stroke-dasharray="10, 10"
     stroke-opacity="0.3"
     id="boundary7" />
  <!-- Arrow markers definition -->
  <defs
     id="defs_markers">
    <marker
       id="arrow"
       markerWidth="10"
       markerHeight="10"
       refX="9"
       refY="3"
       orient="auto">
      <polygon
         points="10,3 0,6 0,0 "
         fill="#34495e"
         id="polygon_arrow" />
    </marker>
    <marker
       id="arrowhead-left"
       markerWidth="10"
       markerHeight="10"
       refX="1"
       refY="3"
       orient="auto">
      <polygon
         points="0,3 10,6 10,0 "
         fill="#9b59b6"
         id="polygon_left" />
    </marker>
    <marker
       id="arrowhead-purple"
       markerWidth="10"
       markerHeight="10"
       refX="9"
       refY="3"
       orient="auto">
      <polygon
         points="10,3 0,6 0,0 "
         fill="#9b59b6"
         id="polygon_purple" />
    </marker>
    <marker
       id="arrowhead-left-0"
       markerWidth="10"
       markerHeight="10"
       refX="1"
       refY="3"
       orient="auto">
      <polygon
         points="10,6 10,0 0,3 "
         fill="#9b59b6"
         id="polygon_left-9" />
    </marker>
    <marker
       id="arrowhead-purple-4"
       markerWidth="10"
       markerHeight="10"
       refX="9"
       refY="3"
       orient="auto">
      <polygon
         points="0,6 0,0 10,3 "
         fill="#9b59b6"
         id="polygon_purple-8" />
    </marker>
  </defs>
  <text
     x="132.20422"
     y="461.07043"
     text-anchor="middle"
     fill="#ffffff"
     font-size="11px"
     font-weight="bold"
     id="text51a-0"
     style="font-size:12px;font-family:Arial">Shard 1/8</text>
  <text
     x="257.20422"
     y="461.07043"
     text-anchor="middle"
     fill="#ffffff"
     font-size="11px"
     font-weight="bold"
     id="text51b-9"
     style="font-size:12px;font-family:Arial">Shard 2/8</text>
  <text
     x="382.20422"
     y="461.07043"
     text-anchor="middle"
     fill="#ffffff"
     font-size="11px"
     font-weight="bold"
     id="text51c-4"
     style="font-size:12px;font-family:Arial">Shard 3/8</text>
  <text
     x="507.20416"
     y="461.07043"
     text-anchor="middle"
     fill="#ffffff"
     font-size="11px"
     font-weight="bold"
     id="text51d-8"
     style="font-size:12px;font-family:Arial">Shard 4/8</text>
  <text
     x="632.20416"
     y="461.07043"
     text-anchor="middle"
     fill="#ffffff"
     font-size="11px"
     font-weight="bold"
     id="text51e-8"
     style="font-size:12px;font-family:Arial">Shard 5/8</text>
  <text
     x="757.20416"
     y="461.07043"
     text-anchor="middle"
     fill="#ffffff"
     font-size="11px"
     font-weight="bold"
     id="text51f-2"
     style="font-size:12px;font-family:Arial">Shard 6/8</text>
  <text
     x="882.20416"
     y="461.07043"
     text-anchor="middle"
     fill="#ffffff"
     font-size="11px"
     font-weight="bold"
     id="text51g-4"
     style="font-size:12px;font-family:Arial">Shard 7/8</text>
  <text
     x="1007.2042"
     y="461.07043"
     text-anchor="middle"
     fill="#ffffff"
     font-size="11px"
     font-weight="bold"
     id="text51h-5"
     style="font-size:12px;font-family:Arial">Shard 8/8</text>
  <rect
     x="85.06958"
     y="386.88574"
     width="974.93042"
     height="50.114254"
     fill="#e67e22"
     stroke="#d68910"
     stroke-width="2"
     rx="3"
     id="rect_shared7" />
  <text
     x="77.742012"
     y="409.39804"
     text-anchor="end"
     fill="#2c3e50"
     font-size="10px"
     font-weight="bold"
     id="shared_label1"
     style="font-size:12px"
     inkscape:export-filename="DP_without_EP.png"
     inkscape:export-xdpi="150"
     inkscape:export-ydpi="150"><tspan
       sodipodi:role="line"
       id="tspan1"
       x="77.742012"
       y="409.39804">Shared</tspan><tspan
       sodipodi:role="line"
       id="tspan2"
       x="77.742012"
       y="424.39804">Experts</tspan></text>
  <text
     x="132.18526"
     y="415.16949"
     text-anchor="middle"
     fill="#ffffff"
     font-size="11px"
     font-weight="bold"
     id="text51a-0-9"
     style="font-size:12px;font-family:Arial">Shard 1/8</text>
  <text
     x="257.18524"
     y="415.16949"
     text-anchor="middle"
     fill="#ffffff"
     font-size="11px"
     font-weight="bold"
     id="text51b-9-4"
     style="font-size:12px;font-family:Arial">Shard 2/8</text>
  <text
     x="382.18524"
     y="415.16949"
     text-anchor="middle"
     fill="#ffffff"
     font-size="11px"
     font-weight="bold"
     id="text51c-4-8"
     style="font-size:12px;font-family:Arial">Shard 3/8</text>
  <text
     x="507.18518"
     y="415.16949"
     text-anchor="middle"
     fill="#ffffff"
     font-size="11px"
     font-weight="bold"
     id="text51d-8-8"
     style="font-size:12px;font-family:Arial">Shard 4/8</text>
  <text
     x="632.18524"
     y="415.16949"
     text-anchor="middle"
     fill="#ffffff"
     font-size="11px"
     font-weight="bold"
     id="text51e-8-2"
     style="font-size:12px;font-family:Arial">Shard 5/8</text>
  <text
     x="757.18512"
     y="415.16949"
     text-anchor="middle"
     fill="#ffffff"
     font-size="11px"
     font-weight="bold"
     id="text51f-2-4"
     style="font-size:12px;font-family:Arial">Shard 6/8</text>
  <text
     x="882.18512"
     y="415.16949"
     text-anchor="middle"
     fill="#ffffff"
     font-size="11px"
     font-weight="bold"
     id="text51g-4-5"
     style="font-size:12px;font-family:Arial">Shard 7/8</text>
  <text
     x="1007.1853"
     y="415.16949"
     text-anchor="middle"
     fill="#ffffff"
     font-size="11px"
     font-weight="bold"
     id="text51h-5-5"
     style="font-size:12px;font-family:Arial"
     inkscape:export-filename="DP_without_EP.png"
     inkscape:export-xdpi="150"
     inkscape:export-ydpi="150">Shard 8/8</text>
</svg>
